!function(i){i(function(){function t(s,e){this.el=i(s),this.el.css("display","none"),this.params=i.extend(this,t.options,e),this.id=this.el.attr("id"),this.withSearch=this.params.withSearch?1:0,this.size=this.params.width?this.params.width:this.el.data("width"),this.enabled=!this.el.attr("disabled"),this.params.className=this.params.className||"",this.ael=i("<div></div>",{for:this.id,class:this.params.mainClass+" "+this.params.className+" "+(this.enabled?"":"disabled")}),this.ael.html(this.tpl()),this.fAel=this.ael.find("."+this.params.firstClass),this.replacement()}t.options={mainClass:"selectable",firstClass:"firstelem",listClass:"listitems"},t.prototype={replacement:function(){i('div[for="'+this.id+'"]').html()&&i('div[for="'+this.id+'"]').remove(),this.el.after(this.ael),this.build(),this.hideIfClickOutside()},hideIfClickOutside:function(){var t=this;i(document).click(function(i){t.isOpen()&&(t.checkPosition(i)||t.hide())})},isOpen:function(){return!!this.ael.hasClass("a")},checkPosition:function(i){return!(!this.ael.is(i.target)&&0===this.ael.has(i.target).length)},hide:function(){this.ael.removeClass("a"),this.withSearch&&(this.aelVal(this.el.find("option:selected").text()),this.fAel.attr("readonly","readonly"))},show:function(){this.ael.addClass("a"),this.ael.find("li").show(),this.fAel.removeAttr("readonly").val("").focus(),this.ael.find("ul").scrollTop(0),this.ael.find("ul").scrollTop(this.ael.find("ul").find(".a").position().top-3)},aelVal:function(i){this.withSearch?(this.fAel.val(i),this.fAel.attr("placeholder","enter text: "+i)):this.fAel.html(i)},build:function(){this.ael.css({width:this.size});var t="",s=this;i.each(this.el.find("option"),function(){var e=!!i(this).is(":selected");e&&s.aelVal(this.text),t+='<li vll="'+this.value+'" '+(e?'class="a"':"")+">"+this.text+"</li>"}),this.ael.find("ul").html(t),this.bindAll()},bindAll:function(){var t=this;this.ael.find("input").on("keyup",function(s){var e=t.ael.find("li"),a=s.target.value.toUpperCase().trim();if(""!=a){var l=Utils.changeLang(a);e.hide(),t.ael.find("p.not_found").remove(),e.each(function(){i(this).text().toUpperCase().indexOf(a)>-1?i(this).show():i(this).text().toUpperCase().indexOf(l)>-1&&i(this).show()}),t.ael.find("ul").children(":visible").length||t.ael.find("ul").append(i("<p>",{class:"not_found",text:"Нет совпадений"}))}else e.show()}),this.ael.find("ul").bind("mousewheel DOMMouseScroll",function(i){var t=i.originalEvent,s=t.wheelDelta||-t.detail;this.scrollTop+=20*(s<0?1:-1),i.preventDefault()}),this.ael.not(".disabled").on("click",function(s){if(i(this).hasClass("a")){if(i(s.target).is(".firstelem")&&t.withSearch)return!0;t.hide()}else t.show()}),this.ael.find("li").on("click",function(){i(this).hasClass("a")||(i(this).parent().children().removeClass("a"),i(this).addClass("a"),t.aelVal(i(this).text()),t.el.val(i(this).attr("vll")),t.el.change())})},tpl:function(){return(this.withSearch?'<input readonly class="'+this.params.firstClass+'"/>':'<div class="'+this.params.firstClass+'"></div>')+'<div class="'+this.params.listClass+'"><ul></ul></div>'}},i.fn.makeSelect=function(i){return new t(this,i)}})}(jQuery);